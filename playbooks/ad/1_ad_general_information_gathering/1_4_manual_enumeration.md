## Active Directory Basic Enumeration (users, computers, groups, policies, trusts) [t-ad-enumeration-ad_enumeration_basics]

###  Dumping Active Directory basic information




**option 1: Windows AD Powershell module**

{% code overflow="wrap" %}
```bash
Get-ADComputer -Filter * -Properties * | Select-Object Name,lastlogon,description,OperatingSystem,OperatingSystemServicePack | export-CSV adcomps.csv -NoTypeInformation -Encoding UTF8
Get-ADUser -Filter * -Properties cn,SAMAccountName,displayName,enabled,Title,Department,Company,whenCreated,whenChanged,passwordlastset,EmailAddress,comment,description,MemberOf | Select-Object cn,SAMAccountName,displayName,enabled, EmailAddress,Title,Department,Company,whenCreated,whenChanged,passwordlastset,comment,description,@{name="MemberOf";expression={($_.Memberof | % {($_ | Get-ADGroup).Name}) -join ","}} | export-CSV adusers.csv -NoTypeInformation -Encoding UTF8

```
{% endcode %}

{% hint style="info" %}Portable version is available - https://github.com/samratashok/ADModule

{% endhint %}


**option 2: ADRecon.ps1**

{% code overflow="wrap" %}
```bash
.\ADRecon.ps1 -DomainController <IP or FQDN> -Credential <domain\username>
```
{% endcode %}

{% hint style="info" %}The .ps1 script can be detected as malicious on the host

{% endhint %}


**option 3: PowerView.ps1**

{% code overflow="wrap" %}
```bash
Get-Domain
Get-DomainUser -Properties cn,SAMAccountName,description,info,comment,displayName,Title,Department,Company,whenCreated,whenChanged,pwdlastset,lastlogontimestamp,MemberOf | export-CSV ad_users_info.csv -NoTypeInformation -Encoding UTF8
Get-NetComputer -Properties ssn,lastlogon,operatingsystem,operatingsystemversion,location,description | export-CSV ad_computer_info.csv -NoTypeInformation -Encoding UTF8
Get-NetDomainController
Invoke-MapDomainTrust
Get-DomainPolicyData
Get-ForestDomain
Get-DomainController
Get-DomainTrust

#for a particular user
Get-DomainUser -Identity jking -Properties DisplayName, MemberOf | fl

Get-DomainGroupMember -Identity "Domain Admins" | select MemberDistinguishedName
Get-DomainGPOUserLocalGroupMapping

```
{% endcode %}


**option 4: SharpView.exe**

{% code overflow="wrap" %}
```bash
SharpView.exe Get-Domain

```
{% endcode %}


**option 5: ADSearch**

{% code overflow="wrap" %}
```bash
ADSearch.exe --search "objectCategory=user"
ADSearch.exe --search "(&(objectCategory=group)(cn=*Admins))"
ADSearch.exe --search "(&(objectCategory=group)(cn=MS SQL Admins))" --attributes cn,member

```
{% endcode %}


**option 6: ldapdomaindump**

{% code overflow="wrap" %}
```bash
ldapdomaindump -u <domain>\\<username> -p '<password>' <dc_address> -r -d ';' -n <ns_server>
```
{% endcode %}


**option 7: go-windapsearch**

{% code overflow="wrap" %}
```bash
windapsearch-linux-amd64 -d <domain.com> --dc <dc01.domain.com> -u <user@domain.com> -p 'P@ssw0rd' -m users

```
{% endcode %}

{% hint style="info" %}Available modules are admin-objects, computers, custom, dns-names, dns-zones, domain-admins, gpos, groups, members, metadata, privileged-users, search, unconstrained, user-spns, users 


{% endhint %}

## Active Directory DNS Dumping [t-ad-dns-ad_dns_dump]

By default any user in Active Directory can enumerate all DNS records in the Domain or Forest DNS zones, similar to a zone transfer.

###  Dumping Active Directory DNS



{% code overflow="wrap" %}
```bash
adidnsdump -u <domain>\\<username> dc01.domain.com -r 
cat records.csv

```
{% endcode %}

