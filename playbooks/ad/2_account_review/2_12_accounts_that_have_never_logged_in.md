## Accounts That Have Never Logged In [t-ad-account_review-users_never_logged_in]

Check if there are any Windows user accounts that have never logged in.

###  Enumerate user accounts that have never logged in.




**option 1: Powershell AD Module**

{% code overflow="wrap" %}
```bash
Get-ADUser -Filter * -Properties Name, sAMAccountName, LastLogonDate, whencreated  | Where { $_.LastLogonDate -eq $null -and $_.Enabled -eq $True -and $_.DistinguishedName  -notlike "*HealthMailbox*"} | Format-Table -AutoSize -Property sAMAccountName, LastLogonDate, whencreated

```
{% endcode %}

{% hint style="info" %}You can add "| Measure-Object" to the powershell command to get a total number of the accounts

{% endhint %}


**option 2: ldapsearch**

{% code overflow="wrap" %}
```bash
ldapsearch -x -H ldap://<dc_ip> -D "<user@domain.com>" -w '<password>' -b "DC=<domain,DC=com>"  "(&(objectCategory=person)(objectClass=user)(lastLogon=0))" sAMAccountName  | grep dn |grep -v HealthMailbox  | wc

```
{% endcode %}


**option 3: bloodhound**

{% code overflow="wrap" %}
```bash
MATCH (u:User) WHERE u.lastlogon IN [-1.0, 0.0] AND NOT u.name starts with 'HEALTHMAILBOX'  RETURN u.name, datetime({epochSeconds:toInteger(u.whencreated)})

```
{% endcode %}

