## Inactive Accounts [t-ad-account_review-inactive_accounts]

Having inactive accounts enabled can increase the organization's attack surface and create potential entry points for attackers. These accounts may still have valid login credentials, and if the passwords are weak or compromised, attackers could use them to gain unauthorized access to sensitive data or systems.
Additionally, former employees could potentially use old credentials to access network resources and engage in malicious activity.

###  Identify accounts that have been inactive for more than 6 months




**option 1: Powershell AD Module**

{% code overflow="wrap" %}
```bash
Import-Module ActiveDirectory
Get-ADUser -Filter * -Properties LastLogonDate | ? { $_.LastLogonDate -lt (get-date).AddDays(-180) -and ($_.LastLogonDate -ne $NULL) -and ($_.Enabled -eq $TRUE) -and $_.DistinguishedName -notlike "*HealthMailbox*"} | Format-Table -AutoSize -Property sAMAccountName, LastLogonDate

```
{% endcode %}

{% hint style="info" %}You can add "| Measure-Object" to the powershell command to get a total number of the accounts

{% endhint %}

![inactive_accounts.png](t-ad-account_review-inactive_accounts/inactive_accounts.png)

**option 2: bloodhound**

{% code overflow="wrap" %}
```bash
MATCH (u:User) WHERE u.lastlogon < (datetime().epochseconds - (180 * 86400)) and NOT u.lastlogon IN [-1.0, 0.0] RETURN u.name,datetime({epochSeconds:toInteger(u.lastlogontimestamp)})
```
{% endcode %}

