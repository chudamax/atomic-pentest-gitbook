## Accounts with "Password Never Expires" Flag [t-ad-account_review-password_never_expires]

Enabling the "Password Never Expires" flag reduces the security of user accounts by allowing users to use the same password indefinitely, which increases the risk of successful brute force attacks and unauthorized access.

###  Enumerate user accounts with the "Password Never Expires" flag enabled




**option 1: Powershell AD Module**

{% code overflow="wrap" %}
```bash
Get-ADUser -Filter {(passwordNeverExpires -eq $true) -and (Enabled -eq $True) -and (sAMAccountName -notlike "*HealthMailbox*")} -Properties sAMAccountName, passwordNeverExpires,PasswordLastSet | Format-Table -AutoSize -Property sAMAccountName,passwordNeverExpires,PasswordLastSet
```
{% endcode %}

{% hint style="info" %}You can add "| Measure-Object" to the powershell command to get a total number of the accounts

{% endhint %}


**option 2: ldapsearch**

{% code overflow="wrap" %}
```bash
ldapsearch -x -H ldap://<dc_ip> -D "<user@domain.com>" -w '<password>' -b "DC=<domain,DC=com>" "(&(objectCategory=person)(objectClass=user)(userAccountControl:1.2.840.113556.1.4.803:=65536)(!(userAccountControl:1.2.840.113556.1.4.803:=2)))" sAMAccountName | grep dn |grep -v HealthMailbox
```
{% endcode %}


**option 3: bloodhound**

{% code overflow="wrap" %}
```bash
MATCH (u:User) WHERE u.pwdneverexpires = true AND u.enabled = TRUE AND NOT u.name starts with 'HEALTHMAILBOX' RETURN u.name
```
{% endcode %}

