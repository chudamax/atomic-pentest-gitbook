# ACL Enumeration

## ACL Enumeration [t-ad-acl-acl_enumeration]

ACL Enumeration


### References:

* [https://habr.com/ru/companies/solarsecurity/articles/681108/](https://habr.com/ru/companies/solarsecurity/articles/681108/)

* [https://ppn.snovvcrash.rocks/pentest/infrastructure/ad/acl-abuse](https://ppn.snovvcrash.rocks/pentest/infrastructure/ad/acl-abuse)

* [https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/abusing-active-directory-acls-aces](https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/abusing-active-directory-acls-aces)

###  ACL Enumeration




**option 1: bloodhound**

{% code overflow="wrap" %}
```bash
MATCH p=(u:User)-[r1]->(n) WHERE r1.isacl=true RETURN p
MATCH p=(u:Computer)-[r1]->(n) WHERE r1.isacl=true RETURN p

```
{% endcode %}


**option 2: powerview**

{% code overflow="wrap" %}
```bash
Find-InterestingDomainAcl -ResolveGUIDs | Export-CSV -NoTypeInformation acls.csv
Find-InterestingDomainAcl -ResolveGUIDs | select IdentityReferenceName, ObjectDN, ActiveDirectoryRights | fl

#Find-InterestingDomainAcl -ResolveGUIDs | ? {$_.IdentityReferenceClass -match "user"}
#Find-InterestingDomainAcl -ResolveGUIDs | ? {$_.IdentityReferenceClass -match "computer"}

```
{% endcode %}

{% hint style="info" %}The generated file can be quite big

{% endhint %}

