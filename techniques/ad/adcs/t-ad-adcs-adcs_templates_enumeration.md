# ADCS Templates Enumeration

## ADCS Templates Enumeration [t-ad-adcs-adcs_templates_enumeration]

### Overview

Once in an AD environment, we can find vulnerable certificate templates


### References:

* [https://github.com/ly4k/BloodHound/](https://github.com/ly4k/BloodHound/)

* [https://0xalwayslucky.gitbook.io/cybersecstack/active-directory/adcs-privesc-certificate-templates](https://0xalwayslucky.gitbook.io/cybersecstack/active-directory/adcs-privesc-certificate-templates)

### 1.1 Enumerate templates on the ADCS Server




**option 1: certipy**

{% code overflow="wrap" %}
```bash
certipy find -u <user@domain.com> -p 'P@ssw0rd' -dc-ip <DC_IP>
```
{% endcode %}

{% hint style="info" %}Since certificate templates are domain object, ACL can have different ACL.  It makes sense to additionally export templates using different user accounts with  different group memberships.


{% endhint %}


**option 2: certify**

{% code overflow="wrap" %}
```bash
Certify.exe cas
Certify.exe find /vulnerable

```
{% endcode %}

### 1.2 Find potentially vulnerable templates



{% code overflow="wrap" %}
```bash
certipy find -u <user@domain.com> -p 'P@ssw0rd' -dc-ip <DC_IP> -vulnerable

bloodhound (ly4k) - use queries in GUI
#OR manually
jq '.[] |.[]| select(.["Enrollee Supplies Subject"] == true and .Enabled == true and .["Client Authentication"] == true)' filename.json

```
{% endcode %}

{% hint style="info" %}vulnerable paramtere doesn't affect bloodhound output, these files always contain all templates including non-vulnerable.

{% endhint %}

