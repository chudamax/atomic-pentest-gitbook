# Crack NetNTLMv1 hashes locally

## Crack NetNTLMv1 hashes locally [t-ad-ntlm-netntlmv1_hashes_cracking]

NetNTLMv1 uses the Data Encryption Standard (DES) algorithm as part of its hash computation process.
The hash NT (16bytes) is divided in 3 parts of 7bytes each.

Modern hardware, especially GPUs, can compute DES hashes very quickly, which makes brute force attacks 
even more effective. Moreover, there are many readily available software tools that are designed 
to crack NetNTLMv1 hashes.



{% hint style="info" %}For NTLMv1 with ESS/SSP the process is a bit different, check the references
If it was not possible to crack the hash, NTLM relay technique can be used
{% endhint %}
### 1.1 Use NTLMv1 Multitool to convert the NetNTLMv1 response to a proper hash



{% code overflow="wrap" %}
```bash
python3 ntlmv1.py --ntlmv1 hashcat::HOSTNAME:<PART1>:<PART2>:<CHALLANGE>
```
{% endcode %}

{% hint style="info" %}<CHALLANGE> is usually 1122334455667788

{% endhint %}

### 1.2 Calculate final 4 characters (CT3)



{% code overflow="wrap" %}
```bash
./ct3_to_ntlm.bin <CT3> <CHALLANGE>
```
{% endcode %}

### 1.3 Crack 2 parts with hashcat



{% code overflow="wrap" %}
```bash
To crack with hashcat create a file with the following contents:
<CT1>:1122334455667788
<CT2>:1122334455667788

./hashcat -m 14000 -a 3 -1 charsets/DES_full.charset --hex-charset hashes.txt ?1?1?1?1?1?1?1?1

```
{% endcode %}

